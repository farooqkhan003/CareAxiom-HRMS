<% include ./template.ejs %>
<!-- write you all code here -->
<div id="main">

    <section>
        <% if(applyLeaveMessage && applyLeaveMessage == 'Leave Applied') { %>
        <label id="response-login" class="btn-block text-center alert alert-success"><%= applyLeaveMessage %></label>
        <% }
        else if(applyLeaveMessage && applyLeaveMessage == 'Could not apply for leave') { %>
        <label id="response-login" class="btn-block text-center alert alert-danger"><%= applyLeaveMessage %></label>
        <% } %>

        <div class="container" style="margin-top: 30px;">
            <div class="profile-head">
                <div class="col-md- col-sm-4 col-xs-12">
                    <img src="http://www.newlifefamilychiropractic.net/wp-content/uploads/2014/07/300x300.gif"
                         class="img-responsive"/>
                    <h6><%= firstName %> <%= lastName %></h6>
                </div><!--col-md-4 col-sm-4 col-xs-12 close-->


                <div class="col-md-5 col-sm-5 col-xs-12">
                    <h5><%= firstName %> <%= lastName %></h5>
                    <p><%= designation %> / <%= rank %></p>
                    <ul>
                        <li><span class="glyphicon glyphicon-briefcase"></span> <%= joinDate %></li>
                        <li><span class="glyphicon glyphicon-home"></span> <%= address %></li>
                        <li title="phone"><span class="glyphicon glyphicon-phone"></span><%= phone %></li>
                        <li title="email"><span class="glyphicon glyphicon-envelope"></span><%= email %></li>
                    </ul>
                </div><!--col-md-8 col-sm-8 col-xs-12 close-->
            </div><!--profile-head close-->
        </div><!--container close-->

        <div id="sticky" class="container">
            <!-- Nav tabs -->

            <ul class="nav nav-tabs nav-menu" role="tablist">
                <li class="active">
                    <a href="#profile" role="tab" data-toggle="tab">
                        <i class="fa fa-male"></i> Profile
                    </a>
                </li>
                <li><a href="#change" role="tab" data-toggle="tab">
                        <i class="fa fa-key"></i> Edit Profile
                    </a>
                </li>
            </ul><!--nav-tabs close-->

            <!-- Tab panes -->
            <div class="tab-content">
                <div class="tab-pane fade active in" id="profile">
                    <div class="container">
                        <% if(editProfileMessage && editProfileMessage == 'Profile edited') { %>
                        <label id="response-login"
                               class="btn-block text-center alert alert-success"><%= editProfileMessage %></label>
                        <% }
                        else if(editProfileMessage && editProfileMessage == 'Could not edit profile') { %>
                        <label id="response-login"
                               class="btn-block text-center alert alert-danger"><%= editProfileMessage %></label>
                        <% } %>
                        <br clear="all"/>
                        <div class="row">
                            <div class="col-md-12">
                                <h4 class="pro-title">Bio Graph</h4>
                            </div><!--col-md-12 close-->


                            <div class="col-md-6">

                                <div class="table-responsive responsiv-table">
                                    <table class="table bio-table">
                                        <tbody>
                                        <tr>
                                            <td>Firstname</td>
                                            <td><%= firstName %></td>
                                        </tr>
                                        <tr>
                                            <td>Lastname</td>
                                            <td><%= lastName %></td>
                                        </tr>
                                        <tr>
                                            <td>Username</td>
                                            <td><%= userName %></td>
                                        </tr>
                                        <tr>
                                            <td>Email</td>
                                            <td><%= email %></td>
                                        </tr>
                                        <tr>
                                            <td>Join Date</td>
                                            <td><%= joinDate %></td>
                                        </tr>
                                        <tr>
                                            <td>Designation</td>
                                            <td><%= designation %></td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div><!--table-responsive close-->
                            </div><!--col-md-6 close-->

                            <div class="col-md-6">

                                <div class="table-responsive responsiv-table">
                                    <table class="table bio-table">
                                        <tbody>
                                        <tr>
                                            <td>Contact</td>
                                            <td><%= phone %></td>
                                        </tr>
                                        <tr>
                                            <td>Salary</td>
                                            <td><%= salary %></td>
                                        </tr>
                                        <tr>
                                            <td>Upcoming Bump</td>
                                            <td><%= bump %></td>
                                        </tr>
                                        <tr>
                                            <td>Upcoming Bonus</td>
                                            <td><%= bonus %></td>
                                        </tr>
                                        <tr>
                                            <td>Available Leaves</td>
                                            <td><%= availableLeaves %></td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div><!--table-responsive close-->
                            </div><!--col-md-6 close-->

                        </div><!--row close-->


                    </div><!--container close-->
                </div><!--tab-pane close-->


                <div class="tab-pane fade" id="change">
                    <div class="container fom-main">
                        <div class="row">
                            <div class="col-sm-12">
                                <h2 class="register">Edit Profile</h2>
                            </div><!--col-sm-12 close-->

                        </div><!--row close-->
                        <br/>
                        <div class="row">

                            <form class="form-horizontal main_form text-left"
                                  action="/profile/update?user=<%= user.userName %>" method="post" id="contact_form">
                                <fieldset>

                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">First Name</label>
                                        <div class="col-md-12 inputGroupContainer">
                                            <div class="input-group">
                                                <input name="firstName" value="<%= firstName %>"
                                                       placeholder="First Name" class="form-control" type="text">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Text input-->

                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Last Name</label>
                                        <div class="col-md-12 inputGroupContainer">
                                            <div class="input-group">
                                                <input name="lastName" value="<%= lastName %>" placeholder="Last Name"
                                                       class="form-control" type="text">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Email</label>
                                        <div class="col-md-12 inputGroupContainer">
                                            <div class="input-group">
                                                <input name="email" value="<%= email %>" placeholder="E-Mail Address"
                                                       class="form-control" type="text">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Contact</label>
                                        <div class="col-md-12 inputGroupContainer">
                                            <div class="input-group">
                                                <input type="text" value="<%= phone %>" class="form-control"
                                                       name="phone" placeholder="Contact"/>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Address</label>
                                        <div class="col-md-12 inputGroupContainer">
                                            <div class="input-group">
                                                <input type="text" value="<%= address %>" class="form-control"
                                                       name="address" placeholder="Address"/>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- only for admin -->
                                    <% if(user && user.rank == 'admin') { %>
                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Designation</label>
                                        <div class="col-md-12 inputGroupContainer">
                                            <div class="input-group">
                                                <select class="form-control" id="" name="designation">
                                                    <option>Software Developer</option>
                                                    <option>Senior Software Developer</option>
                                                    <option>Quality Assurance Engineer</option>
                                                    <option>Human Resource Manager</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <% } %>

                                    <!-- Text input-->
                                    <% if(user && user.rank == 'admin') { %>
                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Salary</label>
                                        <div class="col-md-12 inputGroupContainer">
                                            <div class="input-group">
                                                <input class="form-control" value="<%= salary %>" name="salary"
                                                       placeholder="Salary"/>
                                            </div>
                                        </div>
                                    </div>
                                    <% } %>

                                    <!-- only for admin -->
                                    <% if(user && user.rank == 'admin') { %>
                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Upcomming Bump</label>
                                        <div class="col-md-12 selectContainere">
                                            <div class="input-group">
                                                <input type="text" value="<%= bump %>" class="form-control" name="bump"
                                                       id="bump" placeholder=" Upcomming Bump">
                                            </div>
                                        </div>
                                    </div>
                                    <% } %>

                                    <!-- Select Basic -->
                                    <% if(user && user.rank == 'admin') { %>
                                    <div class="form-group col-md-12">
                                        <label class="col-md-10 control-label">Upcomming Bonus</label>
                                        <div class="col-md-12 selectContainere">
                                            <div class="input-group">
                                                <input type="text" value="<%= bonus %>" class="form-control" id="bonus"
                                                       name="bonus" placeholder="Upcomming Bonus">
                                            </div>
                                        </div>
                                    </div>
                                    <% } %>

                                    <!-- upload profile picture -->
                                    <!--
                                    <div class="col-md-12 text-left">
                                        <div class="uplod-picture">
<span class="btn btn-default uplod-file">
    Upload Photo <input type="file" />
</span>
                                            <span class="btn btn-default uplod-file">
    Upload Resume <input type="file" />
</span>
                                            <span class="btn btn-default uplod-file">
    Upload Video <input type="file" />
</span>
                                        </div> -->
                                    <!--uplod-picture close-->
                                    <!--</div>col-md-12 close-->
                                    <!-- Button -->
                                    <div class="form-group col-md-10">
                                        <div class="col-md-6">
                                            <button type="submit" class="btn btn-success submit-button">Save</button>
                                        </div>
                                    </div>
                                </fieldset>
                            </form>
                        </div><!--row close-->
                    </div><!--container close -->
                </div><!--tab-pane close-->
            </div><!--tab-content close-->
        </div><!--container close-->

    </section><!--section close-->
</div> <!-- end of main -->


<!-- Add New Apply for leave/WFH -->

<div class="modal fade" id="L-WFH-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
     style="display: none;">
    <div class="modal-dialog">
        <div class="loginmodal-container extra-large">
            <h1>Apply For Leave/Work From Home</h1><br>
            <form action="/employee/leave/apply" method="post" id="apply_leave_form">
                <div class="row">
                    <div class="col-md-6">
                        <label>Apply For</label>
                        <select class="form-control" id="" name="leaveType">
                            <option>full day</option>
                            <option>half day</option>
                            <option>work from home</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label>Available Leaves</label>
                        <input disabled class="form-control" value="<%= availableLeaves %>">
                    </div>
                </div>  <!-- end of row -->
                <label>Date</label>
                <input type="text" hidden id="calendar" name="leaveDate" value="">
                <div id="reportrange" class="pull-right"
                     style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 100%; border-radius: 2px;">
                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>&nbsp;
                    <span id="calendar_span"></span> <b class="caret"></b>
                </div>
                <br>
                <label>Description</label>
                <textarea name="reason" id="reason" class="form-control" placeholder="Reason..."></textarea>
                <br>
                <button type="submit" class="btn btn-block btn-success">Apply</button>

            </form> <!-- end of form -->
            <br>
        </div>
    </div>
</div>

<!-- End of Apply for leave/WFH -->

<% if (user && user.rank == 'admin'){ %>
<!-- Delete user for admin -->

<div class="modal fade" id="delete-user" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
     style="display: none;">
    <div class="modal-dialog">
        <div class="loginmodal-container extra-large">
            <h1>Delete User</h1><br>
            <form action="" method="">
                <label for="">Username</label>
                <input class="form-control" placeholder="Username" name="username" id="">
                <input type="submit" class="form-control btn btn-danger">
            </form>
            <br><br>
            <br>
        </div>
    </div>
</div>

<!-- End of Delete user -->
<% } %>
<% include ./footer.ejs %>

<script type="text/javascript">
    $(function () {

        var start = moment().subtract(0, 'days');
        var end = moment();

        function cb(start, end) {
            $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
        }

        $('#reportrange').daterangepicker({
            startDate: start,
            endDate: end,
            ranges: {
                'Today': [moment(), moment()],
                'Tomorrow': [moment().add(1, 'days'), moment().add(1, 'days')],
                'Next 7 Days': [moment().add(1, 'days'), moment().add(7, 'days')]
            }
        }, cb);

        cb(start, end);

    });
    $('#reason').keyup(function () {
        $('#calendar').val($('#calendar_span').text());
        console.log('alu\n');
        console.log($('#calendar').val());
    });
</script>

<!--script for ajax of add user-->
<script>
    $('#adduser-button').click(function () {
        $('#spinner1').removeClass('hidden');
        $('#adduser-button').addClass('disabled');
        $.ajax({
            type: 'POST',
            url: '/employee/new',
            data: {
                firstName: $('#firstName').val(),
                lastName: $('#lastName').val(),
                userName: $('#username').val(),
                password: $('#password').val(),
                email: $('#email').val(),
                phone: $('#phone').val(),
                designation: $('#designation').val(),
                rank: $('#rank').val(),
                salary: $('#salary').val()
            },
            success: function (data) {
                console.log(data);
                $('#adduser-button').removeClass('disabled');
                $('#spinner1').addClass('hidden');
                if (data == 1) {
                    $('#adduser-button').removeClass();
                    $('#adduser-label').addClass('alert alert-success btn-block text-center');
                    $('#adduser-label').html("User Added!!");

                } else {
                    $('#aadduser-button').removeClass('disabled');
                    $('#adduser-label').addClass('alert alert-danger btn-block text-center');
                    $('#adduser-label').html('User not Added.');
                }
            },
            error: function () {
                $('#spinner1').addClass('hidden');
                alert("Error in sending ajax request.");
            }
        });
    });
</script>